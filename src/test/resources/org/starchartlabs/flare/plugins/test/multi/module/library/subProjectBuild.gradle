plugins {
    id 'java'
    id 'jacoco'
    id 'maven-publish'
}

dependencies {
    testCompile 'org.testng:testng'
}

test {
    useTestNG() {
        useDefaultListeners = true
    }
}

publishing {
    publications {
        maven(MavenPublication) {
            from components.java
        }
    }
}

repositories {
    mavenLocal()
}

task outputMavenArtifacts {
    doLast {
        publishing.publications.each { publication ->
            publication.artifacts.withType(MavenArtifact.class) { artifact ->
                project.logger.lifecycle("Artifact Verification: ${project.name}:${publication.name}:${artifact.classifier}")
            }
            
        }
    }
}

task outputTestLogging {
    doLast{
        tasks.withType(Test).all {
            project.logger.lifecycle("${it.name} Exception format: ${it.testLogging.exceptionFormat}")
            
            project.logger.lifecycle("${it.name} Quiet logging: ${it.testLogging.quiet.events}")
            project.logger.lifecycle("${it.name} Info logging: ${it.testLogging.info.events}")
            project.logger.lifecycle("${it.name} Debug logging: ${it.testLogging.debug.events}")
        }
    }
}

check.dependsOn outputTestLogging
check.dependsOn outputMavenArtifacts
